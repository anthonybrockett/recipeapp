{% extends 'base.html' %}
{% block content %}

<div class="detail-page">
    <div class="title">
        <h1>{{ recipe.title }}</h1>
        <h5>Chef: {{ recipe.chef }}</h5>
    </div>

    <div class="photo">
        {% for photo in recipe.photo_set.all %}
        <img src="{{photo.url}}">
        {% empty %}
        <div>No Photos Uploaded</div>
        {% endfor %}
    </div>

    <div class="recipe-all">
        <h5 class="servings">Servings: {{ recipe.servings }}</h5>
        <h5 class="time">Prep Time: {{ recipe.preptime}}</h5>
        <h5 class="time">Cooking Time: {{ recipe.cookingtime }}</h5>
        <h5 class="category">Category: {{ recipe.get_category_display }}</h5>
        <h5 class="heading">Method:</h5>
        <h5 class="heading">Ingredients:</h5>
        <h5 class="contentheader">{{ recipe.method|linebreaks }}</h5>
        <h5 class="contentheader">{{ recipe.ingredients|linebreaks }}</h5>
    </div>

    {% if recipe.chef == request.user %}
        <div class="add-photo">
            <form action="{% url 'add_photo' recipe.id %}" enctype="multipart/form-data" method="POST" alt="Recipe Photo">
                {% csrf_token %}
                <input type="file" name="photo-file" >
                <br><br>
                <input type="submit" value="Upload Photo" class="btn">
            </form>
        </div>

    <div class="edit-delete">
        <a href="{% url 'recipe_update' recipe.id %}"><button class="btn">Edit</button></a>
        <a href="{% url 'recipe_delete' recipe.id %}"><button class="btn">Delete</button></a>
    </div>
    {% endif%}

    <div class="all-comment">
        <div class="add-comment">
            <form action="{% url 'add_comment' recipe.id %}" method="POST">
                {% csrf_token %}
                <table>
                    <tr>
                        <td>Comments</td>
                    </tr>
                    {{ comment_form.as_table }}
                </table>
                <input type="submit" value="Post Comment" class="btn">
            </form>
        </div>
        <div class="view-comment">
            <table class="content-table">
                {% for comment in recipe.comment_set.all %}
                    <tr>
                        <td>{{ comment.chef }}</td>
                        <td>{{ comment.created|date:"M d, Y" }}</td>
                        <td rowspan="2"><a href="{% url 'comment_delete' comment.id %}"><button class="btn">X</button></a></td>
                    </tr>
                    <tr>
                        <td colspan="2">{{ comment.content|linebreaks }}</td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>

    <div class="all-tiptrick">
        <!-- <div class="add-tiptrick">
            <form action="{% url 'add_tiptrick' recipe.id %}" method="POST">
                {% csrf_token %}
                <table>
                    <tr>
                        <td colspan="2">Tips and Tricks</td>
                    </tr>
                    {{ tiptrick_form.as_table }}
                </table>
                <input type="submit" value="Post Tips or Tricks" class="btn">
            </form>
        </div> -->

        <div>
            <form action="{% url 'add_tiptrick' recipe.id %}" method="POST" class="add-tiptrick">
                {% csrf_token %}
                <p class="tiptrickhead">Tips and Tricks</p>
                {{ tiptrick_form.as_p }}
                <input type="submit" value="Post Tips or Tricks" class="btn post-tiptrick">
            </form>
        </div>
                
        {% for tiptrick in recipe.tiptrick_set.all %}
            <div class="view-tiptrick">
                    <p class="tiptrickchef">{{ tiptrick.chef }}</p>
                    <p class="tiptrickdate">{{ tiptrick.created|date:"M d, Y" }}</p> 
                    <p><a href="{% url 'tiptrick_delete' tiptrick.id %}"><button class="btn">X</button></a></p>
                    <p class="content">{{ tiptrick.content }}</p>
            </div>
        {% endfor %}
    </div>
</div>

{% endblock %}